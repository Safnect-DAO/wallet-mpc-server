<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.safnect.wallet.mpc.mapper.chain.ChainMapper">

	<select id="getChain" resultType="Chain">
		select * from (select * from chain where enabled = 1 and visible = 1 order by sno) t
		<if test="walletId != null and walletId.isEmpty()">
			union all
			select c.* from chain c inner join wallet_chain w on c.chain_id = w.chain_id where enabled = 1 and w.wallet_id = #{walletId}
		</if>
	</select>
	
	<select id="getUnadded">
		select c2.* from chain c2
		<where>
			and c2.enabled = 1
			and c2.visible = 0 
			and c2.chain_id not in (select wc.chain_id from wallet_chain wc where wc.wallet_id = #{walletId}) 
			<if test="keyword != null and !keyword.isEmpty()">
				and (c2.name like concat('%', #{keyword} '%') or c2.symbol like concat('%', #{keyword} '%')) 
			</if>
		</where>
		order by c2.sno
	</select>
	
</mapper>